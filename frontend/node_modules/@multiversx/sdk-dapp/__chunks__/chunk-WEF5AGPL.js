import{a as O}from"./chunk-5C4GAWRH.js";import{a as k}from"./chunk-Q2AR5236.js";import{a as U}from"./chunk-4ZTSYZ6M.js";import{a as P}from"./chunk-WXDNXHED.js";import{c as A}from"./chunk-KLQ5IZ6C.js";import{a as q}from"./chunk-MPMLX57E.js";import{a as l,c as h,d as w}from"./chunk-7UBLQIEN.js";import{a as j}from"./chunk-Z3FCAX26.js";import{a as x}from"./chunk-75SQ7UW4.js";import{a as v,c as S}from"./chunk-K5Y5PIZE.js";import{a as E}from"./chunk-7XYHQ72T.js";import{b as I,c as b}from"./chunk-6NZ6PUBT.js";import{h as T,j as B}from"./chunk-7YHU2LQD.js";import{p as R}from"./chunk-EOZJRV5E.js";import{a as L,j as u,m as y}from"./chunk-HBP5N4FR.js";y();B();import{useState as C}from"react";import{ExtensionProvider as J}from"@multiversx/sdk-extension-provider";b();q();R();j();S();S();var lo=({callbackRoute:n,token:D,nativeAuth:d,onLoginRedirect:F})=>{let[m,p]=C(""),[N,i]=C(!1),G=d!=null,t=k(d),o=D,r=A(),f=O();function M(){return u(this,null,function*(){if(f)throw new Error(T);U(),r(w(l.address)),r(h(l)),i(!0);let g=J.getInstance();try{if(!(yield g.init())){console.warn("Something went wrong trying to redirect to wallet login..");return}let _=v(),z=encodeURIComponent(E(n!=null?n:_));if(G&&!o&&(o=yield t.getNativeAuthLoginToken(),!o)){console.warn("Fetching block failed. Login cancelled.");return}o&&t.setLoginToken(o);let H=L({callbackUrl:z},o&&{token:o}),{signature:c,address:e}=yield g.login(H);if(P(g),!e){i(!1),console.warn("Login cancelled."),p("Login cancelled");return}c&&o&&t.setTokenLoginInfo({signature:c,address:e}),r(I({address:e,loginMethod:"extension"})),x({callbackRoute:n,onLoginRedirect:F,options:{signature:c,address:e}})}catch(a){console.error("error logging in",a),p("error logging in"+a.message)}finally{i(!1)}})}let s=Boolean(m);return[M,{loginFailed:s,error:m,isLoading:N&&!s,isLoggedIn:f&&!s}]};export{lo as a};
//# sourceMappingURL=chunk-WEF5AGPL.js.map
