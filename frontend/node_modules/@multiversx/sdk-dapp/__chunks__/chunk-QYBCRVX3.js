import{a as ve}from"./chunk-ADQVPHZD.js";import{b as Ae}from"./chunk-7AO2H7KF.js";import{a as pe}from"./chunk-Q2AR5236.js";import{a as Ne}from"./chunk-H25DOETA.js";import{a as Le}from"./chunk-FXLBPATA.js";import{a as Pe}from"./chunk-MA3ZRSMB.js";import{a as Te}from"./chunk-FGQMESNZ.js";import{a as he}from"./chunk-AQPQAHXL.js";import{a as u}from"./chunk-BIVBSEN7.js";import{a as we}from"./chunk-NYCEZZHS.js";import{a as l,c as ge}from"./chunk-WXDNXHED.js";import{c as ue,f as fe}from"./chunk-RFKFTNQQ.js";import{c as le,d as c}from"./chunk-KLQ5IZ6C.js";import{a as ye}from"./chunk-P64EA6SQ.js";import{a as Ce}from"./chunk-R7VXMYQB.js";import{a as Ie}from"./chunk-FJ2FD4LU.js";import{a as Se}from"./chunk-PQ4DDH3I.js";import{a as me}from"./chunk-SWRV4LUB.js";import{a as ke}from"./chunk-PAVHGJ7A.js";import{a as se}from"./chunk-DI7674Q7.js";import{a as de}from"./chunk-M35KTPQR.js";import{a as ce}from"./chunk-J6DXYXHY.js";import{a as W,b as it}from"./chunk-5MOSR5EF.js";import{b as ie,e as at}from"./chunk-4WFQSRWR.js";import{a as Y,c as Z,d as $,e as ee,f as te,h as oe,k as rt}from"./chunk-6BE2DPWP.js";import{a as K,b as Q,g as X,m as ot}from"./chunk-2RJZ73G3.js";import{b as re,i as ne,l as ae,o as nt}from"./chunk-S55DZJQR.js";import{a as tt}from"./chunk-MPMLX57E.js";import{c as N,d as L,g as j,j as w,k as q}from"./chunk-7UBLQIEN.js";import{e as J,g as T,j as D}from"./chunk-6CPM3VCF.js";import{d as b}from"./chunk-O7A5QY4S.js";import{b as U,c as et}from"./chunk-6NZ6PUBT.js";import{x as $e}from"./chunk-KM2BXRAX.js";import{b as B,d as H,f as O}from"./chunk-E4ZF3CDC.js";import{p as Ze}from"./chunk-EOZJRV5E.js";import{a as P,b as S,j as s,m as V}from"./chunk-HBP5N4FR.js";V();import{useEffect as m,useRef as st,useState as ct}from"react";$e();et();ot();rt();nt();tt();Ze();it();at();var E=!1;function Mt(){let{loginMethod:y,iframeLoginType:De}=c(Y),n=c(ne),be=c(ae),M=c($),We=c(te),f=c(K),_=c(X),x=c(ee),p=c(Z),h=c(re),a=c(oe),g=c(Q),R=a==null?void 0:a.nativeAuthConfig,[F,Ee]=ct(h),Me=pe(R||!1),{data:v,isLoading:z,error:G}=se(f),I=st(!1),t=le(),{setLedgerProvider:_e,ledgerData:k}=Te();ve();let{callbackRoute:xe,logoutRoute:Re}=M||{callbackRoute:"",logoutRoute:""},[Fe]=Ae({callbackRoute:xe,logoutRoute:Re});m(()=>{Ge()},[n]),m(()=>{Ye()},[f,y,h]),m(()=>{Be()},[a==null?void 0:a.nativeAuthToken,f]),m(()=>{He()},[v,z]),m(()=>{Ve()},[_,p,k]),m(()=>{p&&g.address&&Le(g)},[p,g]),m(()=>{ze()},[g.shard,g.address,p,F,h]);function ze(){return s(this,null,function*(){var A;if(!(p&&g.shard!=null))return;let e=Number(g.shard),r=yield de(e);if(!((A=r==null?void 0:r[e])!=null&&A.lastBlock))return;let i=!n.gasStationMetadata||!n.gasStationMetadata[e]||n.gasStationMetadata[e].lastBlock!==r[e].lastBlock,d=F!==h;d&&Ee(h),(i||d)&&t(b({gasStationMetadata:r}))})}function Ge(){return s(this,null,function*(){let o=n.chainId&&![B,H,O].includes(n.chainId)&&!n.roundDuration;if(!!(!n.chainId||o))try{let r=yield ce(),i={};if(r){let d=r;(n.chainId!==d.erd_chain_id||n.roundDuration!==d.erd_round_duration)&&(i.chainId=d.erd_chain_id,i.roundDuration=d.erd_round_duration)}Object.keys(i).length>0&&t(b(i))}catch(r){console.error("Failed refreshing network config:",r)}})}function Ve(){_==null&&x!=null&&k&&t(j({index:x.index,address:f,hasContractDataEnabled:k.dataEnabled,version:k.version}))}function Be(){return s(this,null,function*(){let{remainingParams:{impersonate:o,multisig:e}}=W(["impersonate"]),r=ie(f);if(!(a!=null&&a.nativeAuthToken)||o||e||r)return;let i=me(a==null?void 0:a.nativeAuthToken);(i==null?void 0:i.address)&&i.address!==f&&(t(L(i.address)),yield he())})}function He(){return s(this,null,function*(){if(z){t(w(!0));return}if(G){t(q("Failed getting account")),console.error("Failed getting account ",G);return}if(I.current){I.current=!1,t(w(!1));return}v?t(N(S(P({},v),{address:f,nonce:v.nonce.valueOf()}))):p||t(L("")),t(w(!1))})}function Oe(){return s(this,null,function*(){let o=ue(be);if(l(o),We!=null){try{let e=yield u(),{clearNavigationHistory:r,remainingParams:{signature:i,multisig:d,impersonate:A}}=W(["signature","loginToken","address","multisig","impersonate"]);if(!e)return l(fe),t(J(null)),t(T(null)),r();let C=yield Pe({loginToken:a==null?void 0:a.loginToken,extraInfoData:{multisig:d,impersonate:A},address:e,signature:i,loginService:Me});C&&(I.current=!0,t(w(!0)),t(U({address:C.address,loginMethod:"wallet"})),t(N(S(P({},C),{nonce:we(C)}))),t(w(!1))),r()}catch(e){console.error("Failed authenticating wallet user ",e)}t(T(null))}})}function Ue(){return s(this,null,function*(){let o=yield u(),e=yield Ce(o);e&&l(e)})}function je(){return s(this,null,function*(){let o=yield u(),e=yield Ne({address:o,extrasApiAddress:n.extrasApiAddress});e&&l(e)})}function qe(){return s(this,null,function*(){let o=yield u(),e=yield Se(o);e&&l(e)})}function Je(){return s(this,null,function*(){let o=yield u(),e=yield ke(o);e&&l(e)})}function Ke(){return s(this,null,function*(){var r;let o=yield u(),e=yield ye({address:o,walletUrl:(r=n.customWalletAddress)!=null?r:n.walletAddress});e&&l(e)})}function Qe(){return s(this,null,function*(){let o=yield u();if(!n.metamaskSnapWalletAddress)throw new Error("Metamask snap wallet URL is not set.");let e=yield Ie({address:o,walletUrl:n.metamaskSnapWalletAddress,loginType:De});e&&l(e)})}function Xe(){return s(this,null,function*(){try{t(D(!0)),yield Fe(!1)}catch(o){console.error("Could not initialize WalletConnect")}finally{t(D(!1))}})}function Ye(){return s(this,null,function*(){if(!(y==null||E))switch(y){case"ledger":{E=!0,yield _e(),E=!1;break}case"walletconnectv2":{Xe();break}case"extension":{Ue();break}case"passkey":{je();break}case"metamask":{qe();break}case"opera":{Je();break}case"crossWindow":{Ke();break}case"iframe":Qe();break;case"extra":{ge();break}case"wallet":case"":{Oe();break}default:return}})}return null}export{Mt as a};
//# sourceMappingURL=chunk-QYBCRVX3.js.map
