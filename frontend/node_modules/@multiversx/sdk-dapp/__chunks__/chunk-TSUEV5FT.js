import{a as A}from"./chunk-QGGNJI27.js";import{a as N}from"./chunk-5C4GAWRH.js";import{a as F}from"./chunk-Q2AR5236.js";import{a as O}from"./chunk-4ZTSYZ6M.js";import{a as E}from"./chunk-WXDNXHED.js";import{c as C}from"./chunk-KLQ5IZ6C.js";import{a as W}from"./chunk-MPMLX57E.js";import{a as p,c as w,d as I}from"./chunk-7UBLQIEN.js";import{a as V}from"./chunk-Z3FCAX26.js";import{a as U}from"./chunk-75SQ7UW4.js";import{a as h,c as S}from"./chunk-K5Y5PIZE.js";import{a as v}from"./chunk-7XYHQ72T.js";import{b as T,c as Q}from"./chunk-6NZ6PUBT.js";import{h as P,j as K}from"./chunk-7YHU2LQD.js";import{p as J}from"./chunk-EOZJRV5E.js";import{a as L,j as m,m as k}from"./chunk-HBP5N4FR.js";k();K();import{useState as D}from"react";import{PasskeyProvider as G}from"@multiversx/sdk-passkey-provider/out";Q();W();J();V();S();S();var uo=({callbackRoute:i,token:M,nativeAuth:f,onLoginRedirect:_})=>{let[d,u]=D(""),[z,s]=D(!1),H=f!=null,a=F(f),o=M,{network:{extrasApiAddress:e}}=A(),c=C(),y=N();function R(){return m(this,null,function*(){if(y)throw new Error(P);O(),c(I(p.address)),c(w(p)),s(!0);let n=G.getInstance().setPasskeyServiceUrl(e!=null?e:"");try{if(!(yield n.init())){console.warn("Something went wrong trying to redirect to wallet login..");return}let b=h(),j=encodeURIComponent(v(i!=null?i:b));if(H&&!o&&(o=yield a.getNativeAuthLoginToken(),!o)){console.warn("Fetching block failed. Login cancelled.");return}o&&a.setLoginToken(o);let q=L({callbackUrl:j},o&&{token:o});yield n.login(q),E(n);let{signature:l,address:r}=n.account;if(!r){s(!1),console.warn("Login cancelled."),u("Login cancelled");return}l&&o&&a.setTokenLoginInfo({signature:l,address:r}),c(T({address:r,loginMethod:"passkey"})),U({callbackRoute:i,onLoginRedirect:_,options:{signature:l,address:r}})}catch(t){console.error("error logging in",t),u("Error logging in: "+t.message)}finally{s(!1)}})}let B=n=>m(void 0,null,function*(){let t=G.getInstance().setPasskeyServiceUrl(e!=null?e:"");return yield t.init(),yield t.createAccount({walletName:n})}),g=Boolean(d);return[R,B,{loginFailed:g,error:d,isLoading:z&&!g,isLoggedIn:y&&!g}]};export{uo as a};
//# sourceMappingURL=chunk-TSUEV5FT.js.map
