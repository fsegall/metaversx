import{a as x}from"./chunk-5C4GAWRH.js";import{a as F}from"./chunk-Q2AR5236.js";import{a as _}from"./chunk-4ZTSYZ6M.js";import{a as B}from"./chunk-MA3ZRSMB.js";import{a as G,b as co}from"./chunk-NYCEZZHS.js";import{a as U}from"./chunk-WXDNXHED.js";import{c as N,d as O}from"./chunk-KLQ5IZ6C.js";import{i as M,o as ao}from"./chunk-S55DZJQR.js";import{a as D}from"./chunk-MPMLX57E.js";import{a as p,c as f,d as l}from"./chunk-7UBLQIEN.js";import{e as A}from"./chunk-O7A5QY4S.js";import{a as so}from"./chunk-Z3FCAX26.js";import{a as E}from"./chunk-75SQ7UW4.js";import{b as P,c as io}from"./chunk-6NZ6PUBT.js";import{b as v,c as to}from"./chunk-U3D33KB2.js";import{h as W,j as eo}from"./chunk-7YHU2LQD.js";import{a as k,b as ro}from"./chunk-OWBHRN3S.js";import{p as no}from"./chunk-EOZJRV5E.js";import{a as s,d as oo}from"./chunk-2SDQY5CF.js";import{a as m,b as T,j as C,m as S}from"./chunk-HBP5N4FR.js";S();import{useState as H}from"react";to();eo();oo();io();ao();D();D();no();co();so();ro();var Oo=({callbackRoute:i,token:R,nativeAuth:u,onLoginRedirect:$,hasConsentPopup:z,walletAddress:t})=>{let[L,j]=H(""),[q,a]=H(!1),w=u!=null,c=F(u),o=R,J=O(M),n=N(),y=x();function K(){return C(this,null,function*(){if(y)throw new Error(W);_({skipLoginMethod:"crossWindow"}),n(l(p.address)),n(f(p)),a(!0);let Q=yield s.getInstance().init();t&&n(A(t));let d=s.getInstance().setWalletUrl(t!=null?t:J.walletAddress);try{if(!Q){console.warn("Something went wrong trying to redirect to wallet login..");return}let{origin:r,pathname:V}=k(),X=encodeURIComponent(`${r}${i!=null?i:V}`);if(w&&!o&&(o=yield c.getNativeAuthLoginToken(),!o)){console.warn("Fetching block failed. Login cancelled.");return}o&&c.setLoginToken(o);let Y=m({callbackUrl:X},o&&{token:o});(v&&w||z)&&d.setShouldShowConsentPopup(!0);let{signature:h,address:I,multisig:Z,impersonate:b}=yield d.login(Y);if(!I){a(!1),s.getInstance().onDestroy(),console.warn("Login cancelled.");return}U(d);let e=yield B({loginToken:o,extraInfoData:{multisig:Z,impersonate:b},address:I,signature:h,loginService:c});if(!e)return;n(P({address:e.address,loginMethod:"crossWindow"})),n(l(e.address)),n(f(T(m({},e),{nonce:G(e)}))),E({callbackRoute:i,onLoginRedirect:$,options:{signature:h,address:e.address}})}catch(r){console.error("error loging in",r),j("error logging in"+r.message)}finally{a(!1)}})}let g=Boolean(L);return[K,{loginFailed:g,error:L,isLoading:q&&!g,isLoggedIn:y&&!g}]};export{Oo as a};
//# sourceMappingURL=chunk-MYQBODDO.js.map
