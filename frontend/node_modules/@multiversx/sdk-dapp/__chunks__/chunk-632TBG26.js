import{a as E}from"./chunk-5C4GAWRH.js";import{a as k}from"./chunk-Q2AR5236.js";import{a as P}from"./chunk-4ZTSYZ6M.js";import{a as A}from"./chunk-WXDNXHED.js";import{c as S}from"./chunk-KLQ5IZ6C.js";import{a as q}from"./chunk-MPMLX57E.js";import{a as l,c as T,d as w}from"./chunk-7UBLQIEN.js";import{a as j}from"./chunk-Z3FCAX26.js";import{a as O}from"./chunk-75SQ7UW4.js";import{a as v,c as b}from"./chunk-K5Y5PIZE.js";import{b as I,c as B}from"./chunk-6NZ6PUBT.js";import{h as y,j as $}from"./chunk-7YHU2LQD.js";import{a as h,b as W}from"./chunk-OWBHRN3S.js";import{p as R}from"./chunk-EOZJRV5E.js";import{a as f,j as L,m as u}from"./chunk-HBP5N4FR.js";u();$();import{useState as U}from"react";import{OperaProvider as J}from"@multiversx/sdk-opera-provider";B();q();R();j();b();W();var mo=({callbackRoute:e,token:C,nativeAuth:p,onLoginRedirect:D})=>{let[m,F]=U(""),[N,r]=U(!1),G=p!=null,t=k(p),o=C,s=S(),d=E();function M(){return L(this,null,function*(){if(d)throw new Error(y);P(),s(w(l.address)),s(T(l)),r(!0);let n=J.getInstance();try{if(!(yield n.init())){console.warn("Something went wrong trying to redirect to wallet login..");return}let{origin:_}=h(),x=v(),z=encodeURIComponent(`${_}${e!=null?e:x}`);if(G&&!o&&(o=yield t.getNativeAuthLoginToken(),!o)){console.warn("Fetching block failed. Login cancelled.");return}o&&t.setLoginToken(o);let H=f({callbackUrl:z},o&&{token:o});yield n.login(H),A(n);let{signature:c,address:i}=n.account;if(!i){r(!1),console.warn("Login cancelled.");return}c&&o&&t.setTokenLoginInfo({signature:c,address:i}),s(I({address:i,loginMethod:"opera"})),O({callbackRoute:e,onLoginRedirect:D,options:{signature:c,address:i}})}catch(g){console.error("error loging in",g),F("error logging in"+g.message)}finally{r(!1)}})}let a=Boolean(m);return[M,{loginFailed:a,error:m,isLoading:N&&!a,isLoggedIn:d&&!a}]};export{mo as a};
//# sourceMappingURL=chunk-632TBG26.js.map
